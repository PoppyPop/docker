<source>
  @type  forward
  @id    input1
  @label @mainstream
  port  24224
</source>

<filter **>
  @type stdout
</filter>

<label @mainstream>
  <match nginx.docker.**>
    type parser
    key_name log
    #format nginx
    format /^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*) +\S*)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)" "(?<forwarded>[^\"]*)")?$/
    remove_prefix nginx
    reserve_data yes
  </match>
  <match docker.**>
    @type elasticsearch
	host elasticsearch
	port 9200
	logstash_format true
  </match>
</label>
